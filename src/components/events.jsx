import React, { Component } from "react";
import Pagination from "./common/pagination";
import { paginate } from "../utils/paginate";
import ListGroup from "./common/listGroup";
import EventsList from "./eventsList";
import _ from "lodash";

class Events extends Component {
  state = {
    events: [
      {
        id: 9,
        title: "Workshop Prise de parole en public",
        slug: "workshop-prise-de-parole-en-public",
        description:
          "3 personnes sur 4 redoutent le fait de s‚Äôexprimer en public.\r\nC‚Äôest ce qu‚Äôon appelle la #glossophobie.\r\nEt comme toutes les peurs, celle-ci aussi peut s‚Äôapprivoiser.\r\nC‚Äôest ce que nous vous proposons √† travers ce #workshop.\r\nGr√¢ce √† des techniques √©prouv√©es et une longue exp√©rience en la mati√®re, nous vous apportons tous les outils n√©cessaires √† une prise de parole r√©ussie.\r\nRendez-vous donc au sein de l‚Äô@Institut des Arts Oratoires pour r√©v√©ler le talent qui est en vous.\r\n\r\nWorkshop sur 5 semaines : De mardi 14 juin √† Mardi 12 juillet de 18h √† 20h",
        inventory: 12,
        unit_price: 2500,
        theme: 5,
        city: "Casablanca",
        location: "Acad√©mie de th√©√¢tre Helen O'Grady",
        date: "2022-06-14T18:00:00Z",
        images: [
          {
            id: 10,
            image:
              "http://127.0.0.1:8000/media/event/images/formation-prise-de-parole-en-public-2.jpeg",
          },
        ],
        last_update: "2022-06-10T02:08:38.473014Z",
      },
      {
        id: 8,
        title: "Bocademy Football school",
        slug: "bocademy-football-school",
        description:
          "- Cours de football assur√© par un moniteur professionnel;\r\n\r\n- 5 s√©ances d‚Äôaquagym offertes /an;\r\n\r\n- 1 match/mois gratuit pour les parents des adh√©rents;",
        inventory: 12,
        unit_price: 400,
        theme: 7,
        city: "Rabat",
        location: "Boca cinco",
        date: "2022-07-21T11:20:00Z",
        images: [
          {
            id: 9,
            image:
              "http://127.0.0.1:8000/media/event/images/bocademy-football-school.jpg",
          },
        ],
        last_update: "2022-06-08T19:36:49.609034Z",
      },
      {
        id: 7,
        title: "Yassar - Wald Nass √† Tanger",
        slug: "yassar-wald-nass-a-tanger",
        description:
          'Depuis Comedia en 2010, o√π il fut √©lu grand gagnant, Yassar ne cesse d‚Äô√™tre sollicit√©, que ce soit sur le petit √©cran, ou sur les diff√©rentes sc√®nes du Royaume.  \r\n\r\nCe jeune humoriste a su imposer sa place et aujourd\'hui, en parall√®le du spectacle Humouraji et du duo "2h de rire" avec Rachid Rafik, Yassar lance une tourn√©e avec son tout premier spectacle en solo "Wald Nass".\r\n\r\nAvec son style agressif, incisif, et dr√¥lement m√©chant, Yassar n\'√©pargne personne, et surtout pas son public, conquis d\'avance.',
        inventory: 30,
        unit_price: 200,
        theme: 4,
        city: "Tanger",
        location: "Centre culturel Ahmed Boukmakh",
        date: "2022-06-18T19:30:00Z",
        images: [
          {
            id: 8,
            image:
              "http://127.0.0.1:8000/media/event/images/yassar-wald-nass-a-tanger.jpeg",
          },
        ],
        last_update: "2022-06-08T19:34:50.231288Z",
      },
      {
        id: 6,
        title: "Cycle De Formation WEBDESIGNER CONFIRME",
        slug: "cycle-de-formation-webdesigner-confirme",
        description:
          "Le webdesign correspond √† l‚Äôinterface web et comprend l‚Äôarchitecture interactionnelle,  l‚Äôorganisation des pages, l‚Äôarborescence et la navigation d‚Äôun site web. Le m√©tier de Webdesigner √©quivaut au poste de responsable artistique web qui con√ßoit tout l‚Äôaspect graphique du site en respectant les d√©sirs du client, les imp√©ratifs de marketing et de communication et le public vis√©.\r\n\r\nAujourd‚Äôhui, de plus en plus d‚Äôentreprises font appel √† des professionnels du web et notamment dans le domaine du design (Webdesigners).",
        inventory: 20,
        unit_price: 300,
        theme: 5,
        city: "Casablanca",
        location: "Acad√©mie Marocain de l‚Äôinnovation",
        date: "2022-06-30T09:30:00Z",
        images: [
          {
            id: 7,
            image:
              "http://127.0.0.1:8000/media/event/images/KbbVSUSbiNTgTFOy6TayGD9j83sVb2CmjK7aLNFV.jpeg",
          },
        ],
        last_update: "2022-06-08T19:33:34.548638Z",
      },
      {
        id: 5,
        title: "Soir√©e Masqu√©e",
        slug: "soiree-masquee",
        description:
          "Soir√©e masqu√©e √† l‚Äôhonneur des c√©libataires ! Que vous soyez seuls ou accompagn√©s, vous vous amuserez √† coup s√ªr, ferez de belles rencontres et peut-√™tre m√™me que vous trouverez l‚Äôamour !\r\n\r\nAnonymat garanti : Vous ne partagez vos coordonn√©es qu‚Äôavec ceux qui vous plaisent. \r\n\r\n√Çges admis : entre 25 et 40 ans.",
        inventory: 12,
        unit_price: 200,
        theme: 3,
        city: "Casablanca",
        location: "Fence",
        date: "2022-06-09T19:00:00Z",
        images: [
          {
            id: 6,
            image:
              "http://127.0.0.1:8000/media/event/images/soiree-masquee.jpeg",
          },
        ],
        last_update: "2022-06-08T19:31:07.839309Z",
      },
      {
        id: 4,
        title: "Hassan El Fad √† Oujda",
        slug: "hassan-el-fad-a-oujda",
        description:
          "Le spectacle de Hassan El Fad \"WHO IS KABOUR\" se tiendra le 11 Juin 2022 au Th√©√¢tre Mohammed 6 √† Oujda\r\n\r\nCe personnage a su conqueÃÅrir tous les foyers marocains et a enregistr√© le top audience. Ce nouveau spectacle, intitul√© WHO'S KABOUR, mettra en avant le personnage en toute sa splendeur, avec une mise en sceÃÄne exceptionnelle repr√©sent√©e sous forme d'interviews sur sc√®ne avec ce personnage incorrigible.",
        inventory: 11,
        unit_price: 100,
        theme: 4,
        city: "Oujda",
        location: "Th√©√¢tre Mohammed 6 √† Oujda",
        date: "2022-06-11T19:30:00Z",
        images: [
          {
            id: 5,
            image:
              "http://127.0.0.1:8000/media/event/images/hassan-el-fad-a-oujda-2.jpg",
          },
        ],
        last_update: "2022-06-05T01:17:40.222700Z",
      },
      {
        id: 3,
        title: "Draganov & Stormy",
        slug: "draganov-stormy",
        description:
          'üî¥Etes-vous pr√™t pour une soir√©e de folie?üî¥ "Al Irfane Music & Art Festival" vous pr√©sente deux de votre rappeurs pr√©f√©r√©s STORMY et DRAGANOV en une seule nuit en exclusivit√© √† RABAT. Rendez vous le 5 juin √† Millenium Raa, pour un festival splendide ü§Ø, plein d\'ambiance et de jouissance sensationnel.',
        inventory: 12,
        unit_price: 200,
        theme: 3,
        city: "Rabat",
        location: "üìçMillenium, Souissi, Rabat",
        date: "2022-06-05T20:00:00Z",
        images: [
          {
            id: 4,
            image:
              "http://127.0.0.1:8000/media/event/images/concert-draganov-stormy-limaf-festival-4.png",
          },
        ],
        last_update: "2022-06-05T01:07:55.555093Z",
      },
      {
        id: 2,
        title: "Gnaoua Tour 2022 - ESSAOUIRA",
        slug: "gnaoua-tour-2022-essaouira",
        description:
          'description": "GFT22 I PASS 2 JOURS ESSAOUIRA PASS DU 3 & 4 JUIN ‚Äì DEVANT LA SC√àNE PLACE MOULAY EL HASSAN PROGRAMME Vendredi 3 juin √† la Place Moulay Hassan 20h30 - Ma√¢lem Abdeslam Alikane & Tyour Gnaoua 20h45 - Ma√¢lem Abdeslam Alikane en concert fusion avec Vieux Farka Trio & Aziz Ozouss 22h00 - Ma√¢lem Said Boulhimas en concert fusion avec Jamaaladeen Tacuma Trio 22h45 - Ma√¢lem Abdellah Akharraz',
        inventory: 36,
        unit_price: 400,
        theme: 3,
        city: "Essaouira",
        location: "DEVANT LA SC√àNE PLACE MOULAY EL HASSAN",
        date: "2022-06-03T20:30:00Z",
        images: [
          {
            id: 1,
            image:
              "http://127.0.0.1:8000/media/event/images/gnaoua-tour-2022-essaouira_UZL034o.jpg",
          },
        ],
        last_update: "2022-06-04T14:37:15.988375Z",
      },
      {
        id: 1,
        title: "Green Challenge Tghazout Bay",
        slug: "green-challenge-tghazout-bay",
        description:
          "Retrouvez la 9√©me √©dition de la course d'obstacles engag√©e Green Challenge du 10 au 12 Juin 2022 √† Taghazout.",
        inventory: 15,
        unit_price: 300,
        theme: 8,
        city: "Marrakech",
        location: "Taghazout",
        date: "2022-06-10T09:30:00Z",
        images: [
          {
            id: 3,
            image:
              "http://127.0.0.1:8000/media/event/images/green-challenge-tghazout-bay.png",
          },
        ],
        last_update: "2022-06-04T19:28:30.831350Z",
      },
    ],
    themes: [
      {
        id: 1,
        title: "GNAOUA Festival",
        events_count: 0,
      },
      {
        id: 2,
        title: "JAZZABLANCA Festival",
        events_count: 0,
      },
      {
        id: 3,
        title: "Concerts & Festivals",
        events_count: 3,
      },
      {
        id: 4,
        title: "Th√©√¢tre & Humour",
        events_count: 2,
      },
      {
        id: 5,
        title: "Formations",
        events_count: 1,
      },
      {
        id: 6,
        title: "Salons et congr√®s",
        events_count: 0,
      },
      {
        id: 7,
        title: "Famille & Loisirs",
        events_count: 1,
      },
      {
        id: 8,
        title: "Sport",
        events_count: 1,
      },
      {
        id: 9,
        title: "Cin√©ma",
        events_count: 0,
      },
    ],
    pageSize: 6,
    currentPage: 1,
    sortColumn: {
      column: "title",
      order: "asc",
    },
  };
  //   componentDidMount() {
  //    const themes = [{name: "All Themes"}, ...getThemes()];
  //    this.setState({events: getEvents(), themes});
  //   }
  handlePageChange = (page) => {
    this.setState({ currentPage: page });
  };

  handleThemeSelect = (theme) => {
    this.setState({ selectedTheme: theme, currentPage: 1 });
  };

  //   handleSort = (sortColumn) => {
  //     this.setState({ sortColumn });
  //   };

  render() {
    const { length: count } = this.state.events;
    const {
      currentPage,
      pageSize,
      events: allEvents,
      themes,
      selectedTheme,
      sortColumn,
    } = this.state;

    const filtered =
      selectedTheme && selectedTheme.id
        ? allEvents.filter((e) => e.theme === selectedTheme.id)
        : allEvents;

    const bar =
      filtered.length !== 0
        ? `Showing ${filtered.length} events in the database.`
        : "There are no events in the database.";

    // const sorted = _.orderBy(filtered, [sortColumn.column], [sortColumn.order]);
    const events = paginate(filtered, pageSize, currentPage);
    return (
      <div className="container mt-5">
        <div className="row">
          <div className="col-2">
            <ListGroup
              items={themes}
              onItemSelect={this.handleThemeSelect}
              selectedItem={selectedTheme}
            />
          </div>
          <div className="col">
            <div className="mb-5">{bar}</div>
            {count !== 0 && (
              <EventsList
                events={events}
                onSort={this.handleSort}
                sortColumn={sortColumn}
              />
            )}
            <Pagination
              pageSize={pageSize}
              eventsCount={filtered.length}
              currentPage={currentPage}
              onPageChange={this.handlePageChange}
            />
          </div>
        </div>
      </div>
    );
  }
}

export default Events;
